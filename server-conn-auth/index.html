<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="CVS Version Control Specification"><link href=https://thegoose51.github.io/cvs-spec/server-conn-auth/ rel=canonical><meta name=author content="Cody James May"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../img/favicon.ico><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.4.0"><title>Connection and Authentication - CVS Specification</title><link rel=stylesheet href=../assets/stylesheets/application.0284f74d.css><link rel=stylesheet href=../assets/stylesheets/application-palette.01803549.css><meta name=theme-color content=#7e57c2><script src=../assets/javascripts/modernizr.74668098.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../assets/fonts/material-icons.css><link rel=manifest href=../manifest.json><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-142288438-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-primary=deep-purple data-md-color-accent=pink> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#how-to-connect-to-and-authenticate-oneself-to-the-cvs-server tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://thegoose51.github.io/cvs-spec/ title="CVS Specification" class="md-header-nav__button md-logo"> <i class=md-icon>local_bar</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> CVS Specification </span> <span class=md-header-nav__topic> Connection and Authentication </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/thegoose51/cvs-spec/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> thegoose51/cvs-spec </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://thegoose51.github.io/cvs-spec/ title="CVS Specification" class="md-nav__button md-logo"> <i class=md-icon>local_bar</i> </a> CVS Specification </label> <div class=md-nav__source> <a href=https://github.com/thegoose51/cvs-spec/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> thegoose51/cvs-spec </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. title=Home class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Manual </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Manual </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-1 type=checkbox id=nav-2-1> <label class=md-nav__link for=nav-2-1> Usage </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-1> Usage </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../man-overview/ title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../man-repository/ title=Repository class=md-nav__link> Repository </a> </li> <li class=md-nav__item> <a href=../man-new-project/ title="Starting a New Project" class=md-nav__link> Starting a New Project </a> </li> <li class=md-nav__item> <a href=../man-revisions/ title=Revisions class=md-nav__link> Revisions </a> </li> <li class=md-nav__item> <a href=../man-branching-merging/ title="Branching and Merging" class=md-nav__link> Branching and Merging </a> </li> <li class=md-nav__item> <a href=../man-recursive/ title="Recursive Behavior" class=md-nav__link> Recursive Behavior </a> </li> <li class=md-nav__item> <a href=../man-adding-removing/ title="Adding and Removing" class=md-nav__link> Adding and Removing </a> </li> <li class=md-nav__item> <a href=../man-history/ title="History Browsing" class=md-nav__link> History Browsing </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-2 type=checkbox id=nav-2-2> <label class=md-nav__link for=nav-2-2> CVS and the Real World </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-2> CVS and the Real World </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../man-binary-files/ title="Binary Files" class=md-nav__link> Binary Files </a> </li> <li class=md-nav__item> <a href=../man-mult-developers/ title="Multiple Developers" class=md-nav__link> Multiple Developers </a> </li> <li class=md-nav__item> <a href=../man-revision-management/ title="Revision Management" class=md-nav__link> Revision Management </a> </li> <li class=md-nav__item> <a href=../man-keyword-substitution/ title="Keyword Substitution" class=md-nav__link> Keyword Substitution </a> </li> <li class=md-nav__item> <a href=../man-tracking-sources/ title="Tracking Sources" class=md-nav__link> Tracking Sources </a> </li> <li class=md-nav__item> <a href=../man-builds/ title=Builds class=md-nav__link> Builds </a> </li> <li class=md-nav__item> <a href=../man-special-files/ title="Special Files" class=md-nav__link> Special Files </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-3 type=checkbox id=nav-2-3> <label class=md-nav__link for=nav-2-3> References </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-3> References </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../man-cvs-commands/ title="CVS Commands" class=md-nav__link> CVS Commands </a> </li> <li class=md-nav__item> <a href=../man-invoking-cvs/ title="Invoking CVS" class=md-nav__link> Invoking CVS </a> </li> <li class=md-nav__item> <a href=../man-admin-files/ title="Administrative Files" class=md-nav__link> Administrative Files </a> </li> <li class=md-nav__item> <a href=../man-env/ title="Environment Variables" class=md-nav__link> Environment Variables </a> </li> <li class=md-nav__item> <a href=../man-compatibility/ title=Compatibility class=md-nav__link> Compatibility </a> </li> <li class=md-nav__item> <a href=../man-troubleshooting/ title=Troubleshooting class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../man-credits/ title=Credits class=md-nav__link> Credits </a> </li> <li class=md-nav__item> <a href=../man-bugs/ title=Bugs class=md-nav__link> Bugs </a> </li> <li class=md-nav__item> <a href=../man-cvs-command-list/ title="CVS Command List" class=md-nav__link> CVS Command List </a> </li> <li class=md-nav__item> <a href=../man-index/ title=Index class=md-nav__link> Index </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Client/Server Spec </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Client/Server Spec </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../server-introduction/ title=Introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../server-goals/ title=Goals class=md-nav__link> Goals </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Connection and Authentication </label> <a href=./ title="Connection and Authentication" class="md-nav__link md-nav__link--active"> Connection and Authentication </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#server title=server class=md-nav__link> server </a> </li> <li class=md-nav__item> <a href=#kserver title=kserver class=md-nav__link> kserver </a> </li> <li class=md-nav__item> <a href=#pserver title=pserver class=md-nav__link> pserver </a> </li> <li class=md-nav__item> <a href=#future-possibilities title="future possibilities" class=md-nav__link> future possibilities </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../server-password/ title="Password Scrambling" class=md-nav__link> Password Scrambling </a> </li> <li class=md-nav__item> <a href=../server-protocol/ title=Protocol class=md-nav__link> Protocol </a> </li> <li class=md-nav__item> <a href=../server-protocol-notes/ title="Protocol Notes" class=md-nav__link> Protocol Notes </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../license/ title="GNU Public License" class=md-nav__link> GNU Public License </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>Table of contents</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#server title=server class=md-nav__link> server </a> </li> <li class=md-nav__item> <a href=#kserver title=kserver class=md-nav__link> kserver </a> </li> <li class=md-nav__item> <a href=#pserver title=pserver class=md-nav__link> pserver </a> </li> <li class=md-nav__item> <a href=#future-possibilities title="future possibilities" class=md-nav__link> future possibilities </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/thegoose51/cvs-spec/edit/master/docs/server-conn-auth.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <h1 id=how-to-connect-to-and-authenticate-oneself-to-the-cvs-server>How to Connect to and Authenticate Oneself to the CVS Server<a class=headerlink href=#how-to-connect-to-and-authenticate-oneself-to-the-cvs-server title="Permanent link">#</a></h1> <p>Connection and authentication occurs before the CVS protocol itself is started. There are several ways to connect.</p> <h2 id=server>server<a class=headerlink href=#server title="Permanent link">#</a></h2> <p>If the client has a way to execute commands on the server, and provide input to the commands and output from them, then it can connect that way. This could be the usual rsh (port 514) protocol, Kerberos rsh, SSH, or any similar mechanism. The client may allow the user to specify the name of the server program; the default is <strong><code>cvs</code></strong>. It is invoked with one argument, <code>server</code>. Once it invokes the server, the client proceeds to start the <strong><code>cvs</code></strong> protocol.</p> <h2 id=kserver>kserver<a class=headerlink href=#kserver title="Permanent link">#</a></h2> <p>The kerberized server listens on a port (in the current implementation, by having inetd call <code>cvs kserver</code>) which defaults to 1999. The client connects, sends the usual kerberos authentication information, and then starts the <strong><code>cvs</code></strong> protocol.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Port 1999 is officially registered for another use, and in any event one cannot register more than one port for CVS, so GSS-API (see below) is recommended instead of kserver as a way to support kerberos.</p> </div> <h2 id=pserver>pserver<a class=headerlink href=#pserver title="Permanent link">#</a></h2> <p>The name <code>pserver</code> is somewhat confusing. It refers to both a generic framework which allows the CVS protocol to support several authentication mechanisms, and a name for a specific mechanism which transfers a username and a cleartext password. Servers need not support all mechanisms, and in fact servers will typically want to support only those mechanisms which meet the relevant security needs.</p> <p>The pserver server listens on a port (in the current implementation, by having inetd call <code>cvs pserver</code>) which defaults to 2401 (this port is officially registered). The client connects, and sends the following:</p> <ul> <li>the string <code>BEGIN AUTH REQUEST</code>, a linefeed,</li> <li>the cvs root, a linefeed,</li> <li>the username, a linefeed,</li> <li>the password trivially encoded (see Password scrambling), a linefeed,</li> <li>the string <code>END AUTH REQUEST</code>, and a linefeed.</li> </ul> <p>The client must send the identical string for cvs root both here and later in the Root request of the cvs protocol itself. Servers are encouraged to enforce this restriction. The possible server responses (each of which is followed by a linefeed) are the following. Note that although there is a small similarity between this authentication protocol and the <strong><code>cvs</code></strong> protocol, they are separate.</p> <p><code>I LOVE YOU</code></p> <p>The authentication is successful. The client proceeds with the cvs protocol itself.</p> <p><code>I HATE YOU</code></p> <p>The authentication fails. After sending this response, the server may close the connection. It is up to the server to decide whether to give this response, which is generic, or a more specific response using <code>E</code> and/or <code>error</code>.</p> <p><code>E</code> <em><code>text</code></em></p> <p>Provide a message for the user. After this reponse, the authentication protocol continues with another response. Typically the server will provide a series of <code>E</code> responses followed by <code>error</code>.</p> <div class="admonition warning"> <p class=admonition-title>Compatibility Note</p> <p><strong><code>cvs</code></strong> 1.9.10 and older clients will print <code>unrecognized auth response</code> and <em><code>text</code></em>, and then exit, upon receiving this response.</p> </div> <p><code>error</code> <strong><em><code>code</code></em></strong> <em><code>text</code></em></p> <p>The authentication fails. After sending this response, the server may close the connection. The <strong><em><code>code</code></em></strong> is a code describing why it failed, intended for computer consumption. The only code currently defined is <code>0</code> which is nonspecific, but clients must silently treat any unrecognized codes as nonspecific. The text should be supplied to the user.</p> <div class="admonition warning"> <p class=admonition-title>Compatibility Note</p> <p><strong><code>cvs</code></strong> 1.9.10 and older clients will print <code>unrecognized auth response</code> and <em><code>text</code></em>, and then exit, upon receiving this response.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p><em><code>text</code></em> for this response, or the <em><code>text</code></em> in an <code>E</code> response, is not designed for machine parsing. More vigorous use of code, or future extensions, will be needed to prove a cleaner machine-parseable indication of what the error was.</p> </div> <p>If the client wishes to merely authenticate without starting the <strong><code>cvs</code></strong> protocol, the procedure is the same, except:</p> <ul> <li><code>BEGIN AUTH REQUEST</code> is replaced with <code>BEGIN VERIFICATION REQUEST</code>,</li> <li><code>END AUTH REQUEST</code> is replaced with <code>END VERIFICATION REQUEST</code>,</li> <li>Upon receipt of <code>I LOVE YOU</code> the connection is closed instead of continuing.</li> </ul> <p>Another mechanism is GSSAPI authentication. GSSAPI is a generic interface to security services such as kerberos. GSSAPI is specified in RFC2078 (GSSAPI version 2) and RFC1508 (GSSAPI version 1); we are not aware of differences between the two which affect the protocol in incompatible ways, so we make no attempt to specify one version or the other. The procedure here is to start with <code>BEGIN GSSAPI REQUEST</code>. GSSAPI authentication information is then exchanged between the client and the server. Each packet of information consists of a two byte big endian length, followed by that many bytes of data. After the GSSAPI authentication is complete, the server continues with the responses described above (<code>I LOVE YOU</code>, etc.).</p> <h2 id=future-possibilities>future possibilities<a class=headerlink href=#future-possibilities title="Permanent link">#</a></h2> <p>There are nearly an unlimited number of ways to connect and authenticate. One might want to allow access based on IP address (similar to the usual rsh protocol but with different/no restrictions on ports &lt; 1024), to adopt mechanisms such as Pluggable Authentication Modules (PAM), to allow users to run their own servers under their own usernames without root access, or any number of other possibilities. The way to add future mechanisms, for the most part, should be to continue to use port 2401, but to use different strings in place of <code>BEGIN AUTH REQUEST</code>.</p> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../server-goals/ title=Goals class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> Goals </span> </div> </a> <a href=../server-password/ title="Password Scrambling" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Password Scrambling </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2019 Cody May | Copyright &copy; 2005-2006 Derek Robert Price & Ximbiot | Copyright &copy; 1998 Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111, USA </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../assets/fonts/font-awesome.css> <a href=https://github.com/thegoose51 class="md-footer-social__link fa fa-github"></a> </div> </div> </div> </footer> </div> <script src=../assets/javascripts/application.245445c6.js></script> <script>app.initialize({version:"1.0.4",url:{base:".."}})</script> </body> </html>